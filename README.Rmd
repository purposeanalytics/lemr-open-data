---
output: github_document
editor_options: 
  chunk_output_type: console
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%",
  message = FALSE
)
```
# lemropendata

`lemropendata` is an R interface to the [LEMR Open Data Portal](http://20.220.163.227). The goal of the package is to help read data directly into R without needing to manually download it via the portal.

## Installation

You can install the development version from GitHub with:

``` r
devtools::install_github("purposeanalytics/lemr-open-data")
```

## Usage

Much of the data in the portal is private and requires an authentication token. You can get this from the portal itself, and set up using `set_token()`. Once your token is set up, subsequent functions will automatically retrieve and use the token so that you get all data available to your user.

In the portal, datasets are called **packages**. You can see a list of available packages by using `list_packages()`. This will show metadata about the package, including what tags, state, license, notes, version, and number of resources.

```{r list-packages-example}
library(lemropendata)
packages <- list_packages()
packages
```

Within a package, there are a number of **resources** - e.g. CSV, XSLX, JSON, SHP files, and more. Resources are the actual "data".

For a given package, you can get a list of resources using `list_package_resources()`. You can pass it the package:

```{r list-to-app-layers-resources}
to_app_layers <- packages[packages$title == "Toronto App Layers",] %>%
  list_package_resources()

to_app_layers
```

Finally (and most usefully!), you can download the resource (i.e., the actual data) directly into R using `get_resource()`:

```{r get-resource}
to_points_layers <- to_app_layers[to_app_layers$name == "toronto_points_layers 20230719-202357.rds",] %>%
  get_resource()

to_points_layers
```
